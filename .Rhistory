### ### GOOD TO GO Part 2
data<-read.csv("D:\\CH020 - June\\10.csv",header=T, sep=";")
data<-subset(data, data$Lane==3)
for (i in 360:1260){
Speed_hourly <- subset(data$Speed, data$T>(i-30) & data$T<(i+1))
Speed_1minute <- subset(data$Speed, data$T==i)
Speed_2minute <- subset(data$Speed, data$T>(i-2) & data$T<(i+1))
Speed_5minute <- subset(data$Speed, data$T>(i-5) & data$T<(i+1))
Count_hourly<-(length(Speed_hourly)*2)
Count_1minute<-length(Speed_1minute)
Count_2minute<-length(Speed_2minute)
Count_5minute<-length(Speed_5minute)
Av_Speed_hourly<-mean(Speed_hourly)
Av_Speed_1minute<-mean(Speed_1minute)
Av_Speed_2minute<-mean(Speed_2minute)
Av_Speed_5minute<-mean(Speed_5minute)
Sd_Speed_hourly<-sd(Speed_hourly)
Sd_Speed_1minute<-sd(Speed_1minute)
Sd_Speed_2minute<-sd(Speed_2minute)
Sd_Speed_5minute<-sd(Speed_5minute)
Unsafety_hourly <- sum(subset(data$Unsafety, data$T>(i-30) & data$T<(i+1)))
Unsafety_1minute <- sum(subset(data$Unsafety, data$T==i))
Unsafety_2minute <- sum(subset(data$Unsafety, data$T>(i-2) & data$T<(i+1)))
Unsafety_5minute <- sum(subset(data$Unsafety, data$T>(i-5) & data$T<(i+1)))
parameters<-c(i, Sd_Speed_hourly, Sd_Speed_1minute, Sd_Speed_2minute, Sd_Speed_5minute,Unsafety_hourly, Unsafety_1minute, Unsafety_2minute, Unsafety_5minute)
print(round(parameters,3))
}
d <- "abc"
d[1]
d[2]
input = readline('Enter anything: ')
input = readline('Enter anything: ')
input
aas.numeric(input))
aas.numeric(input)
as.numeric(input)
as.numeric(i)
as.numeric(a)
as.numeric('a')
d <- "abc"
d[2]
input = readline('Enter anything: ')
236
d <- "abc"
d[2]
input = readline('Enter anything: ')
d <- "abc"
d[2]
input = readline(prompt='Enter anything: ')
AverageStepsByDayOfWeek
AverageStepsByDayOfWeek <- StepsByDayOfWeek[,mean(V2), by='DayOfWeek']
StepsByDayOfWeek
NewData
---
title: "Reproducible Research - Assignment No. 1"
author: "Filmon G. Habtemichael"
date: "July 17, 2015"
output: html_document
---
## Loading and preprocessing the data
set the working directory where the files related to this assignemt are located. This is followed by loading the data.
```{r, echo=TRUE, results='hold'}
setwd("C:/Users/Filly/Documents/Reproducible Research - Assignment No. 1")
library(data.table)
data <- read.table("activity.csv", header=T, sep = ",")
data <- data.table(data)  ## converts the dataframe into a datatable
```
In the data, variable date has to be transformed into a time/day format which is recognized by R.
```{r, echo=TRUE, results='hold'}
data$date <- as.Date(data$date)
```
To have a general understanding of the the data that I will be working, I always prefer to view the first and last few rows of the data. This also makes sure that the data was properly read. A a summary statistics of the variables also provide further understanding of the data.
```{r, echo=TRUE, results='hold'}
head(data)
summary(data)
```
## What is mean total number of steps taken per day?
The histogram of the number of steps taken per day can be ploted using the following code:
```{r, echo=TRUE, results='hold'}
StepsPerDay <- data[,sum(steps, na.rm = T), by='date']
hist(StepsPerDay$V1, breaks=seq(0,(max(StepsPerDay$V1)+1000),1000), xlab="No. of Steps per day", main = "Histogram of number of steps per day", col=8)
```
The mean total number of steps taken per day can be obtained by passing the following code:
```{r, echo=TRUE, results='hold'}
MeanStepsPerDay <- round(mean(StepsPerDay$V1), digit=0)
MeanStepsPerDay
MedianStepsPerDay <- round(median(StepsPerDay$V1), digit=0)
MedianStepsPerDay
```
The mean and median steps per day were found to be `r MeanStepsPerDay` and `r MedianStepsPerDay`, respectively.
## What is the average daily activity pattern?
To figureout the average daily activity pattern, number of steps were aggregated at every 5 minutes across all the days. This following code does this:
```{r, echo=TRUE, results='hold'}
StepsEvery5minutes <- data[,sum(steps, na.rm = T), by='interval']
plot(StepsEvery5minutes$interval, StepsEvery5minutes$V1, type="l", col=2, xlab="Time of day (every 5 mintes)", ylab="No. Of steps", main="No. of steps across time of the day")
MaxSteps <- max(StepsEvery5minutes$V1)
TimeIntervalMaxSteps <- which(StepsEvery5minutes$V1 == MaxSteps)
```
Therefore, the average maximum number of steps taken in 5 minutes across all the days was found to be `r MaxSteps` and this happened at the `r: TimeIntervalMaxSteps`th  minute intervak from the midnight, i.e., 8:40 AM.
## Imputing missing values
The following code reveals the number of missing values and imputes them with average of steps in their respective intervals.
```{r, echo=TRUE, results='hold'}
NoOfRowsContainingNAs <- sum(is.na(data))
NoOfRowsContainingNAs
NewData <- data
NewData[,MedianSteps:=median(steps, na.rm = T), by='interval']
NewData$steps[which(is.na(NewData$steps)==TRUE)] <- NewData$MedianSteps[which(is.na(NewData$steps)==TRUE)]
```
In the dataset, there were `r NoOfRowsContainingNAs` rows with incomplete information.
## Are there differences in activity patterns between weekdays and weekends?
After imputing the missing values, we need to check if the mean and median of the steps change or not.
```{r, echo=TRUE, results='hold'}
par(mfrow=c(2,1))
hist(StepsPerDay$V1, breaks=seq(0,(max(StepsPerDay$V1)+1000),1000), xlab="No. of Steps per day", main = "Histogram of number of steps per day\n(Before imputing missing values)", col=8)
NewStepsPerDay <- NewData[,sum(steps, na.rm = T), by='date']
hist(NewStepsPerDay$V1, breaks=seq(0,(max(NewStepsPerDay$V1)+1000),1000), xlab="No. of Steps per day", main = paste("Histogram of number of steps per day\n(After imputing missing values)"), col=8)
NewMeanStepsPerDay <- round(mean(NewStepsPerDay$V1), digit=0)
NewMeanStepsPerDay
NewMedianStepsPerDay <- round(median(NewStepsPerDay$V1), digit=0)
NewMedianStepsPerDay
```
Before imputing the missing values, the mean and median steps per day were `r MeanStepsPerDay` and `r MedianStepsPerDay`, respectively. After imputing the missing values, were found to be `r NewMeanStepsPerDay` and `r NewMedianStepsPerDay`, respectively. As a result of the imputation process, the mean steps per day increased by 150 while the median remained constant. Also to see the significance of this change, some kind of t-test should be applied.
It has to be noted that the change in mean/median of the steps per day might change depending on how the missing values were imputed.
## Are there differences in activity patterns between weekdays and weekends?
```{r}
DayOfWeek <- weekdays(data$date)
WeekDays <- c("Monday","Tuesday","Wednesday","Thursday","Friday")
WeekEnds <- c("Saturday","Sunday")
DayOfWeek[DayOfWeek %in% WeekDays] <- "weekday"
DayOfWeek[DayOfWeek %in% WeekEnds] <- "weekend"
NewData$DayOfWeek <- DayOfWeek
par(mfrow=c(2,1))
StepsByDayOfWeek <- NewData[,list(DayOfWeek, mean(steps, na.rm = T)), by='interval']
AverageStepsByDayOfWeek <- StepsByDayOfWeek[,mean(V2), by='DayOfWeek']
```
AverageStepsByDayOfWeek
dim(AverageStepsByDayOfWeek)
StepsByDayOfWeek
AverageStepsByDayOfWeek <- StepsByDayOfWeek[StepsByDayOfWeek$DayOfWeek == "weekday",mean(V2), by='interval']
AverageStepsByDayOfWeek
AverageStepsWeekDays <- StepsByDayOfWeek[StepsByDayOfWeek$DayOfWeek == "weekday",mean(V2), by='interval']
AverageStepsWeekEnds <- StepsByDayOfWeek[StepsByDayOfWeek$DayOfWeek == "weekend",mean(V2), by='interval']
plot(AverageStepsWeekDays$interval, AverageStepsWeekDays$V1, typ='l')
plot(AverageStepsWeekDays$interval, AverageStepsWeekDays$V1, typ='l', col=2, xlab="Time of day (in minutes)", ylab = "Average steps in weekdays", main = "Average steps in weekdays during the day")
plot(AverageStepsWeekDays$interval, AverageStepsWeekDays$V1, typ='l', col=2, xlab="Time of day (in minutes)", ylab = "Ave. steps in weekdays", main = "Average steps in weekdays during the day")
plot(AverageStepsWeekDays$interval, AverageStepsWeekDays$V1, typ='l', col=2, xlab="Time of day (in minutes)", ylab = "Ave. steps (weekdays)", main = "Average steps in weekdays during the day")
plot(AverageStepsWeekDays$interval, AverageStepsWeekDays$V1, typ='l', col=2, xlab="Time of day (in minutes)", ylab = "Ave. steps \n(weekdays)", main = "Average steps in weekdays during the day")
plot(AverageStepsWeekDays$interval, AverageStepsWeekDays$V1, typ='l', col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekdays during the day")
plot(AverageStepsWeekDays$interval, AverageStepsWeekDays$V1, typ='l', lwd=2, col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekdays during the day")
plot(AverageStepsWeekDays$interval, AverageStepsWeekDays$V1, typ='l', col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekdays during the day")
plot(AverageStepsWeekEnds$interval, AverageStepsWeekEnds$V1, typ='l', lwd=2, col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekdays during the day")
plot(AverageStepsWeekDays$interval, AverageStepsWeekDays$V1, typ='l', lwd=2, col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekdays during the day")
plot(AverageStepsWeekDays$interval, AverageStepsWeekDays$V1, typ='l', lwd=2, col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekdays during the day")
lines(AverageStepsWeekEnds$interval, AverageStepsWeekEnds$V1, typ='l', lwd=2, col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekdays during the day")
StepsByDayOfWeek
AverageStepsWeekDays
AverageStepsWeekEnds
StepsByDayOfWeek
table(StepsByDayOfWeek$DayOfWeek)
AverageStepsWeekEnds <- StepsByDayOfWeek[StepsByDayOfWeek$DayOfWeek == "weekend",mean(V2), by='interval']
www <- StepsByDayOfWeek[StepsByDayOfWeek$DayOfWeek == "weekday",]
www
www <- StepsByDayOfWeek[StepsByDayOfWeek$DayOfWeek == "weekend",]
www
StepsInWeekDays <- StepsByDayOfWeek[StepsByDayOfWeek$DayOfWeek == "weekday",]
StepsInWeekEnds <- StepsByDayOfWeek[StepsByDayOfWeek$DayOfWeek == "weekend",]
AverageStepsWeekDays <- StepsInWeekDays[,mean(V2), by='interval']
StepsInWeekEnds
StepsInWeekDays <- StepsByDayOfWeek[StepsByDayOfWeek$DayOfWeek == "weekday",]
StepsInWeekEnds <- StepsByDayOfWeek[StepsByDayOfWeek$DayOfWeek == "weekend",]
AverageStepsWeekDays <- StepsInWeekDays[,mean(V2), by='interval']
AverageStepsWeekEnds <- StepsInWeekEnds[,mean(V2), by='interval']
AverageStepsWeekEnds <- StepsByDayOfWeek[StepsByDayOfWeek$DayOfWeek == "weekend",mean(V2), by='interval']
plot(AverageStepsWeekDays$interval, AverageStepsWeekDays$V1, typ='l', lwd=2, col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekdays during the day")
lines(AverageStepsWeekEnds$interval, AverageStepsWeekEnds$V1, typ='l', lwd=2, col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekdays during the day")
plot(AverageStepsWeekDays$interval, AverageStepsWeekDays$V1, typ='l', lwd=2, col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekdays during the day")
lines(AverageStepsWeekEnds$interval, AverageStepsWeekEnds$V1, typ='l', lwd=2, col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekdays during the day")
AverageStepsWeekDays <- StepsInWeekDays[,mean(V2), by='interval']
AverageStepsWeekEnds <- StepsInWeekEnds[,mean(V2), by='interval']
plot(AverageStepsWeekDays$interval, AverageStepsWeekDays$V1, typ='l', lwd=2, col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekdays during the day")
lines(AverageStepsWeekEnds$interval, AverageStepsWeekEnds$V1, typ='l', lwd=2, col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekdays during the day")
AverageStepsWeekDays
AverageStepsWeekDays <- StepsInWeekDays[,list(DayOfWeek, mean(V2)), by='interval']
AverageStepsWeekDays
AverageStepsWeekEnds <- StepsInWeekEnds[,list(DayOfWeek, mean(V2)), by='interval']
AverageStepsWeekEnds
NewData
StepsInWeekDays <- NewData[NewData$DayOfWeek == "weekday",]
StepsInWeekEnds <- NewData[NewData$DayOfWeek == "weekend",]
AverageStepsWeekDays <- StepsInWeekDays[,list(DayOfWeek, mean(V2)), by='interval']
AverageStepsWeekEnds <- StepsInWeekEnds[,list(DayOfWeek, mean(V2)), by='interval']
StepsInWeekDays
AverageStepsWeekDays <- StepsInWeekDays[,list(DayOfWeek, mean(steps)), by='interval']
AverageStepsWeekDays
plot(AverageStepsWeekDays$interval, AverageStepsWeekDays$V1, typ='l', lwd=2, col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekdays during the day")
plot(AverageStepsWeekDays$interval, AverageStepsWeekDays$V2, typ='l', lwd=2, col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekdays during the day")
lines(AverageStepsWeekEnds$interval, AverageStepsWeekEnds$V2, typ='l', lwd=2, col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekdays during the day")
AverageStepsWeekEnds <- StepsInWeekEnds[,list(DayOfWeek, mean(steps)), by='interval']
plot(AverageStepsWeekDays$interval, AverageStepsWeekDays$V2, typ='l', lwd=2, col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekdays during the day")
plot(AverageStepsWeekEnds$interval, AverageStepsWeekEnds$V2, typ='l', lwd=2, col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekdays during the day")
plot(AverageStepsWeekEnds$interval, AverageStepsWeekEnds$V2, typ='l', lwd=2, col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekends during the day")
StepsInWeekDays <- NewData[NewData$DayOfWeek == "weekday",]
StepsInWeekEnds <- NewData[NewData$DayOfWeek == "weekend",]
AverageStepsWeekDays <- StepsInWeekDays[,list(DayOfWeek, mean(steps)), by='interval']
AverageStepsWeekEnds <- StepsInWeekEnds[,list(DayOfWeek, mean(steps)), by='interval']
par(mfrow=c(2,1))
plot(AverageStepsWeekDays$interval, AverageStepsWeekDays$V2, typ='l', lwd=2, col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekdays during the day")
plot(AverageStepsWeekEnds$interval, AverageStepsWeekEnds$V2, typ='l', lwd=2, col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekends during the day")
par(mar=c(2,2,2,2))
plot(AverageStepsWeekDays$interval, AverageStepsWeekDays$V2, typ='l', lwd=2, col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekdays during the day")
plot(AverageStepsWeekEnds$interval, AverageStepsWeekEnds$V2, typ='l', lwd=2, col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekends during the day")
source('~/.active-rstudio-document', echo=TRUE)
par(mar=c(3,3,3,3))
plot(AverageStepsWeekDays$interval, AverageStepsWeekDays$V2, typ='l', lwd=2, col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekdays during the day")
plot(AverageStepsWeekEnds$interval, AverageStepsWeekEnds$V2, typ='l', lwd=2, col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekends during the day")
par(mar=c(4,4,3,3))
plot(AverageStepsWeekDays$interval, AverageStepsWeekDays$V2, typ='l', lwd=2, col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekdays during the day")
plot(AverageStepsWeekEnds$interval, AverageStepsWeekEnds$V2, typ='l', lwd=2, col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekends during the day")
hist(StepsPerDay$V1, breaks=seq(0,(max(StepsPerDay$V1)+1000),1000), xlab="No. of Steps per day", main = "Histogram of number of steps per day", col=8)
par(mar=c(4,4,3,3))
par(mfrow=c(2,1))
par(mar=c(4,4,3,3))
hist(StepsPerDay$V1, breaks=seq(0,(max(StepsPerDay$V1)+1000),1000), xlab="No. of Steps per day", main = "Histogram of number of steps per day\n(Before imputing missing values)", col=8)
NewStepsPerDay <- NewData[,sum(steps, na.rm = T), by='date']
hist(NewStepsPerDay$V1, breaks=seq(0,(max(NewStepsPerDay$V1)+1000),1000), xlab="No. of Steps per day", main = paste("Histogram of number of steps per day\n(After imputing missing values)"), col=8)
par(mfrow=c(2,1))
par(mar=c(4,4,3,3))
plot(AverageStepsWeekDays$interval, AverageStepsWeekDays$V2, typ='l', lwd=2, col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekdays during the day")
plot(AverageStepsWeekEnds$interval, AverageStepsWeekEnds$V2, typ='l', lwd=2, col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekends during the day")
plot(AverageStepsWeekDays$interval, AverageStepsWeekDays$V2, typ='l', lwd=2, col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekdays during the day", ylim=c(0,200))
plot(AverageStepsWeekEnds$interval, AverageStepsWeekEnds$V2, typ='l', lwd=2, col=2, xlab="Time of day (in minutes)", ylab = "Steps", main = "Average steps in weekends during the day", ylim=c(0,200))
